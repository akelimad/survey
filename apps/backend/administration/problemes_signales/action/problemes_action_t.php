<?phpsession_start();if (isset($_SESSION["abb_admin"]) && $_SESSION["abb_admin"] != "root") {    header("Location: ../../../");}if (!isset($_SESSION["abb_admin"]) || $_SESSION["abb_admin"] == "") {    header("Location: ../../../login/");}        require_once dirname(__FILE__) . "/../../../../../config/config.php";function couperChaine($chaine, $nbrMotMax , $nbrMotCarct=null ) {    $chaineNouvelle = "";    $i = 0;    $t_chaineNouvelle = explode(" ", $chaine);    foreach ($t_chaineNouvelle as $cle => $mot) {        if ($cle < $nbrMotMax) {            $chaineNouvelle .= $mot . " ";        }        $i++;    }        if ($i <= $nbrMotMax){          $chaine=substr($chaine,0,$nbrMotCarct).'...';        return $chaine;        }    else{                $chaineNouvelle=substr($chaineNouvelle,0,$nbrMotCarct).'...';        return $chaineNouvelle;        }}function time_ago($date, $granularity = 2){    $date = strtotime($date);    $difference = time() - $date;    $periods = array(        'decade' => 315360000,        'année'   => 31536000,        'mois'  => 2628000,        'semaine'   => 604800,         'jour'    => 86400,        'heure'   => 3600,        'minute' => 60,        'seconde' => 1);        $retval = '';    if ($difference < 1)    {        $retval = "moins de 1 second";    }    else    {        foreach ($periods as $key => $value)        {            if ($difference >= $value)            {                $time = floor($difference/$value);                $difference %= $value;                $retval .= ($retval ? ' ' : '').$time.' ';                $retval .= (($time > 1 && $key !=mois) ? $key.'s' : $key);                $granularity--;            }            if ($granularity == '0')            {                break;            }        }    }    return $retval;      }$tag_s = array("&lt;p&gt;", "&lt;/p&gt;");if(isset($_GET['id_action']) && $_GET['id_action']!='') $_SESSION['id_action']=$_GET['id_action'];$id_action=$_SESSION['id_action'];         $dt = date('Y-m-d H:i:s'); $c0=(isset($_POST['c'])) ? $_POST['c'] : '';$dsii= (isset($_POST['id_rprob'])) ? $_POST['id_rprob'] : '';$titre=(isset($_POST['titre'])) ? $_POST['titre'] : '';$pour=(isset($_POST['pour'])) ? $_POST['pour'] : '';$msg=(isset($_POST['msg'])) ? $_POST['msg'] : '';$sts = $c0;$id_a = isset($_SESSION['id_role']) ? $_SESSION['id_role'] : "";$id_c = isset($_SESSION['abb_id_candidat']) ? $_SESSION['abb_id_candidat'] : "";if(isset($_POST['Valider'])) {    if($id_c=='' && $id_a!='') {        $id_u=$id_a;    }elseif($id_c!='' && $id_a=='') {        $id_u=$id_c;    }else {        $id_u='';    }    /* modifier le probléme signalé */    if($id_action!='' && $titre !="" && $msg !="" ){        getDB()->create('root_signale_prob_r', [            'id_prob' => $id_action,            'titre' => $titre,            'msg' => $msg,            'pour' => $pour,            'date_rprob' => $dt,            'id_user' => $id_u        ]);        if( $c0 != '' ){             getDB()->update('root_signale_probleme', 'id_prob', $id_action, [                'etape' => $c0            ]);            redirect(get_current_url());        }    }}if(isset($_POST['modifier'])) {    getDB()->update('root_signale_prob_r', 'id_rprob', $dsii, [        'titre' => $titre,        'msg' => $msg,        'pour' => $pour,        'status' => ($pour < 100) ? 1 : 2    ]);} $_SESSION['link_bak_a']=6;$_SESSION['link_bak_b']=65;$ariane=" Admin > Gestion des problèmes signalés ";	    ?>	